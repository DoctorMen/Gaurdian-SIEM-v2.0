# ============================================================
# Guardian SIEM v2.0 - Master Configuration
# ============================================================

database:
  path: "database/guardian_events.db"

dashboard:
  host: "0.0.0.0"
  port: 5001
  secret_key: "change-me-in-production"

ips:
  threshold: 100          # packets per window to trigger alert
  window_seconds: 5       # sliding window size

alerting:
  enabled: true
  email:
    enabled: false
    smtp_server: "smtp.gmail.com"
    smtp_port: 587
    sender: "guardian-siem@example.com"
    password: ""           # Use env var GUARDIAN_SMTP_PASSWORD in production
    recipients:
      - "soc-team@example.com"
  slack:
    enabled: false
    webhook_url: ""        # Use env var GUARDIAN_SLACK_WEBHOOK in production

threat_intel:
  abuseipdb:
    enabled: false
    api_key: ""            # Use env var ABUSEIPDB_API_KEY
    cache_ttl_hours: 24
  virustotal:
    enabled: false
    api_key: ""            # Use env var VIRUSTOTAL_API_KEY
    cache_ttl_hours: 24

geoip:
  enabled: true
  database_path: "database/GeoLite2-City.mmdb"   # Download from MaxMind

log_ingestion:
  watch_paths:
    - "service_logs/"
  poll_interval_seconds: 5
  sources:
    windows_event_log:
      enabled: true
      log_names: ["Security", "System", "Application"]
      event_ids: [4625, 4624, 4672, 1102, 7045]   # Failed logon, success logon, special priv, log clear, service install
    sysmon:
      enabled: false
      log_name: "Microsoft-Windows-Sysmon/Operational"
    file_logs:
      enabled: true
      patterns:
        - "*.log"
        - "*.txt"

syslog:
  udp_enabled: true
  tcp_enabled: true
  bind_address: "0.0.0.0"
  udp_port: 1514              # Use 1514 to avoid needing root/admin for 514
  tcp_port: 1514
  max_message_size: 8192

active_response:
  enabled: false               # ⚠️  Enable only when you understand the impact
  dry_run: true                # When true, logs actions but doesn't modify firewall
  auto_block: false            # Automatically block IPs (requires enabled + dry_run=false)
  severity_threshold: "HIGH"   # Minimum severity to trigger a block
  block_duration_minutes: 60
  max_blocks_per_hour: 20
  whitelist:
    - "127.0.0.1"
    - "::1"
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"

yara:
  enabled: true
  rules_directory: "config/yara_rules"
  max_file_size_mb: 50
  scan_on_ingest: false        # Scan files dropped into service_logs/

sigma:
  enabled: true
  rules_directory: "config/sigma_rules"

auth:
  enabled: false               # Set to true to require login on dashboard
  session_timeout_minutes: 480

reports:
  output_directory: "reports"
  default_period_hours: 24
